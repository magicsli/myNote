### web静态缓存方案



不久前上线了一个react开发的单页spa应用;

​	因为是单页开发, 而且没有做上线的资源压缩准备,  = = .  主要是没啥配置经验, 导致整个页面加载非得卡顿, 每一次方位都要重复加载相同的js, css img 等静态资源

​	为了提高用户体验, 我尝试使用静态缓存的方式存储这些静态资源, 让用户在访问的时候可以直接从缓存中获取. 不需要再从我的那个小小的服务器获取资源, 这样既提高页面加载速度, 也大大的减轻了我服务器的压力, 作为个人服务器来说, 这么多资源被浪费在重复的请求上.实在是可惜;

​	静态缓存很简单, 只需要在html中设置一个manifest属性. 然后在服务器稍微设置.就可以实现.但是这里边坑也不少.搞的有点头皮发麻:



​	**要实现静态缓存.必须要有SSL`证书, 且通过`https`协议进行访问.  然后如果你不会配置服务器配置的话 = = 嘿嘿嘿嘿. 就和我一样去看文档吧.**



###简单谈谈我的实现:

+ 1, 将我的站点通过代理. 挂载在 443 端口 ( https )端口上

+ 2, 将项目中访问路径也设置在443 端口上;  
  +  修改socketIO中的路径为 `wss://www.magicsli.com`
  +  这里我犯了一个错误, 我初始设置为 ` wss://www.magicsli.com:8080`
  +  = =  .然后又改到了80,然后发现擦嘞, 我是`https`访问. 为什么要设置端口???
  + 然后终于改对了
+ 3, 创建一个manifest 文件.  不要瞎几把加什么后缀 = =.  直接.text 就解决了.. 我也不知道那些博客里为啥非得设置为.appche....什么什么的! text天下第一
  + 至于设置细节我就不多说了,大家自己去查阅文档吧. 我就不多赘述了
+ 4,  在`index.html`的`HTML`根标签中添加manifest属性指向为我们添加的文件
+ 5,  注意, 一定要注意路径,一定要注意路径,一定要注意路径. 这点很重要
+ 6, 将需要静态缓存在用户浏览器的文件路径写在manifest文件里.然后把整个前端项目静态托管 ( 因为我用的后台时 Node + express )

​			







### 增加几条注意事项

+ 1,  静态缓存的文件不能超过4m, 且用且珍惜吧
+ 2, 服务器第一次加载以及你更新manifest文件时的第一次加载会很慢
  + 因为这个时候依然要向服务器发送请求更新文件
+ 3, 你更新文件内容后, 切记. 要更新manifest文件. 这点很重要.我就忘了几次.搞得头皮发麻
+ 4, 缓存文件更新时可能会有冲突性问题, 当更新时可能加载的还是上一次缓存的静态文件. 所以我们托管的文件要慎重. 数据类的文件不允许缓存. 
+ 5, 总结一下:  缓存量小. 数据存在刷新不及时问题. 但是 = =.可以大大的提高我们的网站访问速度.  所以如果你和我一样需要托管一下静态的图片,css类型的静态资源.可以考虑一下这门技术. 很优秀,很强大